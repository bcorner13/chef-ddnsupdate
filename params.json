{"name":"Chef DDNSupdate","tagline":"Installs/Configures nsupdate to manage host dynamic dns and other RR","body":"ddnsupdate Cookbook\r\n===================\r\n\r\nThis is a [Chef] cookbook for Managing BIND DNS Resource Records using nsupdate.\r\n\r\nThis cookbook was primarily developed to Manage an Internal BIND DNS Domain Dynamic Records for Instances\r\nin Amazon EC2 infrastructure (where DHCP could not perform DNS Dynamic Records Updates, this\r\nmight change in the future), but this cookbook is not limited just to Amazon EC2 and could be\r\nused to manage ant BIND DNS Domain Dynamic Records.\r\n\r\nCurrently it supports common RR types `[A PTR CNAME MX]`, more\r\nfeatures and attributes will be added over time, **feel free to contribute**\r\nwhat you find missing!\r\n\r\n\r\n## Supported DDNS Resource Record Types\r\n\r\n- A\r\n- PTR\r\n- CNAME\r\n- MX (limited support for MX RR priority)\r\n\r\n\r\n## Cookbook Recipes\r\n\r\n- `ddnsupdate::install`   - install bind utils package and setup DDNSSEC Key file\r\n\r\n- `ddnsupdate::host`  \t\t- configure nsupdate to manage Host DDNS A & PTR RR\r\n\r\n- `ddnsupdate::rr`   \t\t\t- manage DDNS RR via node attribute using LWRP\r\n\r\n\r\n## Cookbook Repository\r\n\r\nhttps://github.com/vkhatri/ddnsupdate\r\n\r\n\r\n## Cookbook Dependencies\r\n\r\nNone\r\n\r\n\r\n## Cookbook rr LWRP\r\n\r\n**LWRP - ddnsupdate_rr*\r\n\r\nrr LWRP is used to create/delete Dynamic DNS RR.\r\n\r\n**LWRP example**\r\n\r\n*RR via node attribute:*\r\n\r\n    \"default_attributes\": {\r\n      \"ddnsupdate\": {\r\n        \"rr\": {\r\n          \"create\": {\r\n            \"resource record name\": {\r\n              \"type\": \"A\",\r\n              \"value\": [\r\n                \"resource record ip address 1\",\r\n                \"resource record ip address 2\"\r\n              ],\r\n              \"ttl\": 300 # override default ttl value\r\n            },\r\n            \"resource record ip\": {\r\n              \"type\": \"PTR\",\r\n              \"value\": [\r\n                \"resource record name 1\",\r\n                \"resource record name 2\"\r\n              ],\r\n              \"ttl\": 900\r\n            },\r\n            \"resource record zone\": {\r\n              \"type\": \"MX\",\r\n              \"priority\": 10,\r\n              \"value\": [\r\n                \"resource record name\"\r\n              ]\r\n            }\r\n          },\r\n          \"delete\": {\r\n            \"resource record name\": {\r\n              \"type\": \"type\",\r\n              \"value\": \"resource record value\",\r\n              \"purge\": false\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n*Create a RR using LWRP*\r\n\r\n    ddnsupdate_rr rr_name_description\r\n      option option_name\r\n    end\r\n\r\n*Delete a RR using LWRP*\r\n\r\n    ddnsupdate_rr rr_name_description\r\n      option option_name\r\n      action :delete\r\n    end\r\n\r\n*Delete a RR with Purge using LWRP*\r\n\r\nA RR like A or PTR could point to more than one record value. To delete RR entirely\r\nset RR attribute `purge`.\r\n\r\n    ddnsupdate_rr rr_name_description\r\n      option option_name\r\n      purge  true\r\n      action :delete\r\n    end\r\n\r\n**LWRP Options**\r\n\r\nnsupdate Reference: `man nsupdate`\r\n\r\nParameters:\r\n\r\n- *type (required)*\t\t\t\t\t- RR type, e.g. A PTR CNAME MX\r\n- *ttl (default: `node.ddnsupdate.ttl`)*\t\t\t\t- RR ttl value\r\n- *purge (default: false)*\t- delete all RR record values, in conjunction with action :delete\r\n- *value (default: `[]`, required)*\t\t\t\t- array of RR value(s)\r\n- *server (default: `node.ddnsupdate.server`)*\t- RR server to create/delete\r\n- *zone (require)*\t\t\t\t\t\t\t\t- RR zone\r\n- *priority (default: 10)*\t- MX RR priority\r\n- *ddnssec_key_file (default: `node.ddnsupdate.ddnssec.file`)*\t- RR ddnssec key file\r\n- *resolv_conf_file (default: `/etc/resolv.conf`)*\t\t\t\t- resolv conf file\r\n\r\n## Cookbook core Attributes\r\n\r\n * `default[:ddnsupdate][:server]` (default: `nil`): ddns server, overrides /etc/resolv.conf dns server lookup, required if `default[:ddnsupdate][:use_resolv_conf]` is not set\r\n * `default[:ddnsupdate][:use_resolv_conf]` (default: `nil`): if set, sets `default[:ddnsupdate][:resolv_conf]` attributes and `default[:ddnsupdate][:server]`\r\n\r\n        If there is no server ip address configured via attribute\r\n        default[:ddnsupdate][:server], this attribute will use\r\n        first nameserver entry from /etc/resolv.conf file.\r\n\r\n * `default[:ddnsupdate][:ttl]` (default: `300`): RR TTL value\r\n\r\n## Cookbook ddnssec Attributes\r\n\r\n\r\n * `default[:ddnsupdate][:ddnssec][:manage]` (default: `true`): if true manages bind ddnssec configuration file `node[:ddnsupdate][:ddnssec][:key_file]`\r\n * `default[:ddnsupdate][:ddnssec][:file]` (default: `/etc/nsupdate.key`): bind ddnssec key configuration file\r\n * `default[:ddnsupdate][:ddnssec][:name]` (default: `nil`): bind ddnssec key name\r\n * `default[:ddnsupdate][:ddnssec][:algo]` (default: `HMAC-MD5`): bind ddnssec key algo\r\n * `default[:ddnsupdate][:ddnssec][:secret]` (default: `nil`): bind dnssec secret\r\n * `default[:ddnsupdate][:ddnssec][:template_cookbook]` (default: `ddnsupdate`): bind dnssec configuration file template\r\n * `default[:ddnsupdate][:ddnssec][:template_source]` (default: `nsupdate.key.erb`): bind dnssec configuration file template\r\n\r\n\r\n## Cookbook host Attributes\r\n\r\n * `default[:ddnsupdate][:host][:config]` (default: `/etc/nsupdate`): ddnsupdate host nsupdate config file\r\n * `default[:ddnsupdate][:host][:nsupdate_bin]` (default: `/usr/local/bin/host_nsupdate`): nsupdate script for host\r\n * `default[:ddnsupdate][:host][:zone]` (default: `node.domain`): ddnsupdate host nsupdate config file\r\n * `default[:ddnsupdate][:host][:reverse_zone]` (default: `/etc/nsupdate`, required): ddnsupdate host nsupdate config file\r\n * `default[:ddnsupdate][:host][:auto_fqdn_zone]` (default: `true`): use node fqdn domain\r\n\r\n\r\n## Cookbook host nsupdate crond Attributes\r\n\r\n * `default[:ddnsupdate][:ddnssec][:cron][:host][:minute]` (default: `*/15`): host nsupdate cron schedule minutes interval\r\n * `default[:ddnsupdate][:ddnssec][:cron][:host][:hour]` (default: `*`): host nsupdate cron schedule hour interval\r\n * `default[:ddnsupdate][:ddnssec][:cron][:host][:user]` (default: `root`): host nsupdate cron schedule user\r\n * `default[:ddnsupdate][:ddnssec][:cron][:host][:action]` (default: `create`): crond resource action, set it to delete to prevent cron schedule\r\n\r\n\r\n## Cookbook rr nsupdate Attributes\r\n\r\n * `default[:ddnsupdate][:rr][:create]` (default: `{}`): create dynamic dns records via nsupdate\r\n * `default[:ddnsupdate][:rr][:delete]` (default: `{}`): delete dynamic dns records via nsupdate\r\n\r\n    Note: Check & LWRP Examples for advanced attributes.\r\n\r\n\r\n## Cookbook host Recipe Usage\r\n\r\nInclude recipe `ddnsupdate::host` to node run_list to manage Host DDNS A & PTR Records.\r\n\r\n\r\n## Cookbook rr Recipe Usage\r\n\r\nInclude recipe `ddnsupdate::rr` to a node run_list to manage DDNS RR via node attribute `default[:ddnsupdate][:rr]`.\r\n\r\nNote: This recipe does not require to be added to all the nodes, adding to one node or two is sufficient to manage RRs.\r\n\r\n\r\n*RR Create*\r\n\r\nCreating a RR is simple, but it is important to point out that RR value is an array and every time a value is added to a RR, it\r\nwill keep appending it to existing RR.\r\n\r\nMay be in future purge will be added to action :create like :delete\r\n\r\n\r\n*RR Delete*\r\n\r\nDeleting a RR is also simple. Like action :create, :delete will only delete defined RR(s).\r\n\r\n\r\n*RR Delete with Purge*\r\n\r\nTo purge all the RR values completely enable `purge` attribute for RR as defined in the LWRP examples.\r\n\r\n\r\n## Chef role to manage node ddns and RR\r\n\r\nBelow Chef role is a sample to manage host and other RR.\r\n\r\nThis sample uses first nameserver defined in /etc/resolv.conf file.\r\n\r\n    \"default_attributes\": {\r\n      \"ddnsupdate\": {\r\n        \"use_resolv_conf\": true,\r\n\t\t\t\t\"ttl\": 300,\r\n\r\n        \"ddnssec\": {\r\n          \"name\": \"internal.domain.com\",\r\n          \"secret\": \"XYZXYZ.....\"\r\n\t\t\t\t\t},\r\n\r\n        \"host\": {\r\n          \"reverse_zone\": \"10.in-addr.arpa\"\r\n        },\r\n\r\n        \"rr\": {\r\n          \"create\": {\r\n            \"test00.internal.domain.com\": {\r\n              \"type\": \"A\",\r\n              \"zone\": \"internal.domain.com\",\r\n              \"value\": [\r\n                \"10.0.0.101\",\r\n                \"10.0.0.102\"\r\n              ]\r\n            },\r\n            \"10.0.0.101\": {\r\n              \"type\": \"PTR\",\r\n              \"zone\": \"10.in-addr.arpa\",\r\n              \"value\": [\r\n                \"test00.internal.domain.com\"\r\n              ]\r\n            },\r\n            \"10.0.0.102\": {\r\n              \"type\": \"PTR\",\r\n              \"zone\": \"10.in-addr.arpa\",\r\n              \"value\": [\r\n                \"test00.internal.domain.com\"\r\n              ]\r\n            },\r\n            \"test02.internal.domain.com\": {\r\n              \"server\": \"10.0.1.2\",\r\n              \"type\": \"cname\",\r\n              \"zone\": \"internal.domain.com\",\r\n              \"value\": [\r\n                \"test00.internal.domain.com\"\r\n              ]\r\n            }\r\n          },\r\n          \"delete\": {\r\n            \"test01.internal.domain.com\": {\r\n              \"purge\": false,\r\n              \"type\": \"cname\",\r\n              \"ttl\": 300,\r\n              \"zone\": \"internal.domain.com\",\r\n              \"value\": [\r\n                \"test00.internal.domain.com\"\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n\r\nTo use a differenet DNS server, update below attributes:\r\n\r\n    \"default_attributes\": {\r\n      \"ddnsupdate\": {\r\n        \"use_resolv_conf\": false,\r\n        \"server\": \"10.0.0.1\",\r\n\t\t\t\t...\r\n\r\n\r\n## Contributing\r\n\r\n1. Fork the repository on Github\r\n2. Create a named feature branch (like `add_component_x`)\r\n3. Write your change\r\n4. Write tests for your change (if applicable)\r\n5. Run the tests, ensuring they all pass\r\n6. Write description about changes\r\n7. Submit a Pull Request using Github\r\n\r\n\r\n## Copyright & License\r\n\r\nAuthors:: Virender Khatri and [Contributors]\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\r\n\r\n[Chef]: https://www.getchef.com/chef/\r\n[Contributors]: https://github.com/vkhatri/chef-ddnsupdate/graphs/contributors\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}